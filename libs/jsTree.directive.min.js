/*
 * jstree.directive [http://www.jstree.com]
 * http://arvindr21.github.io/jsTree-Angular-Directive
 *
 * Copyright (c) 2014 Arvind Ravulavaru
 * Licensed under the MIT license.
 */
var ngJSTree=angular.module("jsTree.directive",[]);ngJSTree.directive("jsTree",function(b){var a={restrict:"EA",fetchResource:function(d,c){return b.get(d).then(function(e){if(c){c(e.data)}})},managePlugins:function(f,g,c,d){if(c.treePlugins){d.plugins=c.treePlugins.split(",");d.core=d.core||{};d.core.check_callback=true;if(d.plugins.indexOf("state")>=0){d.state=d.state||{};d.state.key=c.treeStateKey}if(d.plugins.indexOf("search")>=0){var h=false;g.after('<input type="text" placeholder="Search Tree" class="ng-tree-search"/>').next().on("keyup",function(e){if(h){clearTimeout(h)}h=setTimeout(function(){a.tree.jstree(true).search(e.target.value)},250)})}if(d.plugins.indexOf("checkbox")>=0){d.checkbox=d.checkbox||{};d.checkbox.keep_selected_style=false}if(d.plugins.indexOf("contextmenu")>=0){if(c.treeContextmenu){d.contextmenu=d.contextmenu||{};d.contextmenu.items=function(){return f[c.treeContextmenu]}}}if(d.plugins.indexOf("types")>=0){if(c.treeTypes){d.types=f[c.treeTypes];console.log(d)}}}return d},manageEvents:function(j,k,f){if(f.treeEvents){var g=f.treeEvents.split(";");for(var h=0;h<g.length;h++){if(g[h].length>0){var d=g[h].split(":")[0]+".jstree",c=g[h].split(":")[1];a.tree.on(d,j[c])}}}},link:function(d,f,c){$(function(){var e={};c.treeData=c.treeData?c.treeData.toLowerCase():"";c.treeSrc=c.treeSrc?c.treeSrc.toLowerCase():"";if(c.treeData=="html"){a.fetchResource(c.treeSrc,function(g){f.html(g);a.init(d,f,c,e)})}else{if(c.treeData=="json"){a.fetchResource(c.treeSrc,function(g){e={core:{data:g}};a.init(d,f,c,e)})}else{if(c.treeData=="scope"){d.$watch(c.treeModel,function(){e={core:{data:d[c.treeModel]}};$(f).jstree("destroy");a.init(d,f,c,e)},true)}else{if(c.treeAjax){e={core:{data:{url:c.treeAjax,data:function(g){return{id:g.id!="#"?g.id:1}}}}};a.init(d,f,c,e)}}}}})},init:function(f,g,c,d){a.managePlugins(f,g,c,d);this.tree=$(g).jstree(d);a.manageEvents(f,g,c)}};return a});